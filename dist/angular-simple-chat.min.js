/*
 * angular-simple-chat 1.0.0
 * @description AngularJS chat directive
 * @link https://github.com/vogloblinsky/angular-simple-chat#readme
 * @license MIT
 */
!function(){"use strict";function e(){var e={bindToController:!0,controller:s,controllerAs:"cb",restrict:"AE",templateUrl:"directives/chat-bubble/chat-bubble.html",scope:{message:"=",localUser:"=",toUser:"="}};return e}function s(e){this.options=e.options()}function t(){var e={bindToController:!0,controller:a,controllerAs:"mc",restrict:"AE",templateUrl:"directives/message-composer/message-composer.html",scope:{localUser:"=",sendFunction:"=",sendButtonText:"=",composerPlaceholderText:"="}};return e}function a(e){this._send=function(){var s={id:"sc"+Date.now(),text:this.rawmessage,userId:this.localUser.userId,date:Date.now()};this.sendFunction(s),e.$emit("simple-chat-message-posted"),this.rawmessage=""}}function n(e){function s(s,t,a){var n=angular.element(t.children()[0])[0];s.$on("simple-chat-message-posted",function(){e(function(){n.scrollTop=n.scrollHeight},0)})}var t={bindToController:!0,controller:r,controllerAs:"sc",link:s,restrict:"AE",templateUrl:"directives/simple-chat/simple-chat.html",scope:{messages:"=",localUser:"=",toUser:"=",sendFunction:"=",showUserAvatar:"=",sendButtonText:"@",composerPlaceholderText:"@"}};return t}function r(e){angular.isDefined(this.showUserAvatar)&&e.setShowUserAvatar(this.showUserAvatar)}s.$inject=["SimpleChatConfiguration"],a.$inject=["$scope"],n.$inject=["$timeout"],r.$inject=["SimpleChatConfiguration"],angular.module("angular-simple-chat",["angular-simple-chat.directives","angularMoment"]),angular.module("angular-simple-chat.directives",[]),angular.module("angular-simple-chat.directives").directive("chatBubble",e),angular.module("angular-simple-chat.directives").directive("messageComposer",t),function(){function e(){var e={showUserAvatar:!0};this.options=function(){return e},this.setShowUserAvatar=function(s){e.showUserAvatar=s}}angular.module("angular-simple-chat.directives").service("SimpleChatConfiguration",e),e.$inject=[]}(),angular.module("angular-simple-chat.directives").directive("simpleChat",n),angular.module("angular-simple-chat.directives").run(["$templateCache",function(e){e.put("directives/chat-bubble/chat-bubble.html",'<div ng-if="cb.localUser.userId !== cb.message.userId">\n    <img class="profile-avatar left"\n        ng-src="{{cb.toUser.avatar}}"\n        ng-if="cb.options.showUserAvatar"/>\n    <div class="chat-bubble-container left"\n        ng-class="{\'reset-margin-left\': !cb.options.showUserAvatar}">\n        <div class="message-detail">\n            <b>{{cb.toUser.username}}, </b>\n            <span am-time-ago="cb.message.date"></span>\n        </div>\n        <div class="chat-bubble left">\n            <div class="message">{{cb.message.text}}</div>\n        </div>\n    </div>\n</div>\n<div ng-if="cb.localUser.userId === cb.message.userId">\n    <img class="profile-avatar right"\n        ng-src="{{cb.localUser.avatar}}"\n        ng-if="cb.options.showUserAvatar"/>\n    <div class="chat-bubble-container right"\n        ng-class="{\'reset-margin-right\': !cb.options.showUserAvatar}">\n        <div class="message-detail">\n            <b>{{cb.localUser.username}}, </b>\n            <span am-time-ago="cb.message.date"></span>\n        </div>\n        <div class="chat-bubble right">\n            <div class="message">{{cb.message.text}}</div>\n        </div>\n    </div>\n</div>\n'),e.put("directives/message-composer/message-composer.html",'<form name="composeForm">\n    <textarea placeholder="{{mc.composerPlaceholderText || \'Write your message here.\'}}"\n            ng-model="mc.rawmessage"\n            name="message"\n            ng-required="true"></textarea>\n    <button ng-click="mc._send()"\n        ng-disabled="composeForm.$invalid">{{mc.sendButtonText || \'Send\'}}</button>\n</form>\n'),e.put("directives/simple-chat/simple-chat.html",'<div class="simple-chat-container">\n    <div ng-repeat="message in sc.messages track by message.id" class="message-wrapper">\n        <chat-bubble\n            message="message"\n            local-user="sc.localUser"\n            to-user="sc.toUser"\n            class="chat-bubble-main-container"\n        ></chat-bubble>\n    </div>\n</div>\n<message-composer\n    local-user="sc.localUser"\n    send-function="sc.sendFunction"\n    send-button-text="sc.sendButtonText"\n    composer-placeholder-text="sc.composerPlaceholderText"\n></message-composer>\n')}])}();